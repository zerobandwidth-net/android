<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ContentUtils.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">debugAndroidTest</a> &gt; <a href="index.source.html" class="el_package">net.zerobandwidth.android.lib.content</a> &gt; <span class="el_source">ContentUtils.java</span></div><h1>ContentUtils.java</h1><pre class="source lang-java linenums">package net.zerobandwidth.android.lib.content;

import android.content.BroadcastReceiver;
import android.content.ClipData;
import android.content.ClipboardManager;
import android.content.Context;
import android.content.Intent;
import android.net.Uri;
import android.util.Log;

import net.zerobandwidth.android.lib.R;

import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;

/**
 * Provides convenience methods and canonical implementations of methods for
 * working with content in general.
 * @since zerobandwidth-net/android 0.1.2 (#27)
 */
@SuppressWarnings( &quot;unused&quot; )                              // This is a library.
<span class="nc" id="L22">public class ContentUtils</span>
{
<span class="fc" id="L24">	protected static final String LOG_TAG = ContentUtils.class.getSimpleName() ;</span>

/// Static constants: ContentResolver syntax ///////////////////////////////////

	/**
	 * The magic word used by {@link android.content.ContentResolver#query} to
	 * specify that results should be sorted in ascending order.
	 * @since zerobandwidth-net/android 0.1.7 (#39)
	 */
	public static final String QUERY_ORDER_ASCENDING = &quot;ASC&quot; ;

	/**
	 * The magic word used by {@link android.content.ContentResolver#query} to
	 * specify that results should be sorted in descending order.
	 * @since zerobandwidth-net/android 0.1.7 (#39)
	 */
	public static final String QUERY_ORDER_DESCENDING = &quot;DESC&quot; ;

	/**
	 * The character that stands in for a variable value in the Android format
	 * string that is supplied to methods of
	 * {@link android.content.ContentResolver}.
	 * @since zerobandwidth-net/android 0.1.7 (#39)
	 */
	public static final String QUERY_VARIABLE_MARKER = &quot;?&quot; ;

/// Static constants: MIME types ///////////////////////////////////////////////

	/** MIME type &quot;text/plain&quot; */
	public static final String MIMETYPE_TEXT_PLAIN = &quot;text/plain&quot; ;

/// Static singleton references ////////////////////////////////////////////////

	/**
	 * A persistent reference to the system's clipboard manager.
	 */
<span class="fc" id="L60">	public static ClipboardManager s_mgrClipboard = null ;</span>

/// Static methods /////////////////////////////////////////////////////////////

	/**
	 * Retrieves the system's clipboard manager. If an instance is not already
	 * maintained in the class, then it will be fetched and bound there.
	 * @param ctx the context from which to retrieve the manager instance
	 * @return the manager instance
	 */
	public static ClipboardManager getClipboardManager( Context ctx )
	{
<span class="nc bnc" id="L72" title="All 2 branches missed.">		if( s_mgrClipboard == null )</span>
		{
<span class="nc" id="L74">			s_mgrClipboard = ((ClipboardManager)</span>
<span class="nc" id="L75">					( ctx.getSystemService( Context.CLIPBOARD_SERVICE ) )) ;</span>
		}
<span class="nc" id="L77">		return s_mgrClipboard ;</span>
	}

	/**
	 * Copies the specified plain text into the clipboard.
	 * @param ctx the context in which to operate
	 * @param sClipLabel the &quot;label&quot; of the new clipboard item
	 * @param sText the plain text to be copied
	 * @see ClipboardManager#setPrimaryClip(ClipData)
	 */
	public static void copyTextToClipboard( Context ctx, String sClipLabel, String sText )
	{
<span class="nc" id="L89">		ClipData clip = ClipData.newPlainText( sClipLabel, sText ) ;</span>
<span class="nc" id="L90">		getClipboardManager(ctx).setPrimaryClip(clip) ;</span>
<span class="nc" id="L91">	}</span>

	/**
	 * Copies the specified plain text into the clipboard.
	 * The &quot;label&quot; of the new clipboard item is defaulted to the value of the
	 * {@link R.string#app_name} resource, which is usually the name of the
	 * current app.
	 * @param ctx the context in which to operate
	 * @param sText the plain text to be copied
	 * @see ClipboardManager#setPrimaryClip(ClipData)
	 */
	public static void copyTextToClipboard( Context ctx, String sText )
<span class="nc" id="L103">	{ copyTextToClipboard( ctx, ctx.getString(R.string.app_name), sText ) ; }</span>

	/**
	 * Copies the specified plain text into the clipboard.
	 * @param ctx the context in which to operate
	 * @param sClipLabel the &quot;label&quot; of the new clipboard item
	 * @param resText the resource ID of the text to be added to the clipboard
	 * @see ClipboardManager#setPrimaryClip(ClipData)
	 */
	public static void copyTextToClipboard( Context ctx, String sClipLabel, int resText )
<span class="nc" id="L113">	{ copyTextToClipboard( ctx, sClipLabel, ctx.getString(resText) ) ; }</span>

	/**
	 * Copies the specified plain text into the clipboard.
	 * The &quot;label&quot; of the new clipboard item is defaulted to the value of the
	 * {@link R.string#app_name} resource, which is usually the name of the
	 * current app.
	 * @param ctx the context in which to operate
	 * @param resText the resource ID of the text to be added to the clipboard
	 * @see ClipboardManager#setPrimaryClip(ClipData)
	 */
	public static void copyTextToClipboard( Context ctx, int resText )
	{
<span class="nc" id="L126">		copyTextToClipboard( ctx, ctx.getString( R.string.app_name ),</span>
<span class="nc" id="L127">				ctx.getString(resText) ) ;</span>
<span class="nc" id="L128">	}</span>

	/**
	 * Opens the OS-standard &quot;share&quot; dialog, using the specified text content to
	 * be shared.
	 * @param ctx the context in which to open the dialog
	 * @param sText the text to be shared
	 * @param sTitle the title of the dialog
	 */
	public static void shareText( Context ctx, String sText, String sTitle )
	{
<span class="nc" id="L139">		Intent sigShare = new Intent( Intent.ACTION_SEND ) ;</span>
<span class="nc" id="L140">		sigShare.putExtra( Intent.EXTRA_TEXT, sText ) ;</span>
<span class="nc" id="L141">		sigShare.setType( MIMETYPE_TEXT_PLAIN ) ;</span>
<span class="nc" id="L142">		ctx.startActivity( Intent.createChooser( sigShare, sTitle ) ) ;</span>
<span class="nc" id="L143">	}</span>

	/**
	 * Opens the OS-standard &quot;share&quot; dialog, using the specified text content to
	 * be shared.
	 * @param ctx the context in which to open the dialog
	 * @param sText the text to be shared
	 * @param resTitle the resource ID of the string for the dialog title
	 */
	public static void shareText( Context ctx, String sText, int resTitle )
<span class="nc" id="L153">	{ shareText( ctx, sText, ctx.getString( resTitle ) ) ; }</span>

	/**
	 * Opens the OS-standard &quot;share&quot; dialog, using the specified text content to
	 * be shared.
	 * The title of the dialog is defaulted to the value of
	 * {@link R.string#title_diaShare_default} provided by this library, which
	 * may be overridden in the app that consumes this library.
	 * @param ctx the context in which to operate
	 * @param sText the text to be shared
	 */
	public static void shareText( Context ctx, String sText )
<span class="nc" id="L165">	{ shareText( ctx, sText, R.string.title_diaShare_default ) ; }</span>

	/**
	 * Dispatches an intent to view Twitter's &quot;tweet&quot; intent page, using the
	 * specified text as the contents of the tweet. This will usually trigger
	 * either the Twitter app or a browser window to open, allowing the user to
	 * confirm the tweet.
	 * @param ctx the context in which to attempt the tweet
	 * @param sTweet the tweet text
	 * @throws UnsupportedEncodingException if the tweet text cannot be
	 *  URL-encoded in UTF-8, as specified within the function
	 */
	public static void tweetText( Context ctx, String sTweet )
	throws UnsupportedEncodingException
	{
<span class="nc" id="L180">		final String sShare = (new StringBuilder())</span>
<span class="nc" id="L181">				.append( &quot;https://twitter.com/intent/tweet?text=&quot; )</span>
<span class="nc" id="L182">				.append( URLEncoder.encode( sTweet, &quot;UTF-8&quot; ) )</span>
<span class="nc" id="L183">				.toString()</span>
				;
<span class="nc" id="L185">		Uri uriShare = Uri.parse( sShare ) ;</span>
<span class="nc" id="L186">		ctx.startActivity( new Intent( Intent.ACTION_VIEW, uriShare ) ) ;</span>
<span class="nc" id="L187">	}</span>

	/**
	 * As {@link #tweetText(Context, String)}, but catches the possible
	 * {@link UnsupportedEncodingException} internally, by logging an error.
	 * @param ctx the context in which to attempt the tweet
	 * @param sTweet the tweet text
	 * @return {@code true} if the attempt succeeded, or {@code false} if an
	 *  {@link UnsupportedEncodingException} was caught
	 */
	public static boolean tryToTweetText( Context ctx, String sTweet )
	{
<span class="nc" id="L199">		try { tweetText( ctx, sTweet ) ; return true ; }</span>
<span class="nc" id="L200">		catch( UnsupportedEncodingException x )</span>
		{
<span class="nc" id="L202">			Log.e( LOG_TAG, (new StringBuilder())</span>
<span class="nc" id="L203">					.append( &quot;Could not encode text: &quot; )</span>
<span class="nc" id="L204">					.append( sTweet )</span>
<span class="nc" id="L205">					.toString()</span>
				, x ) ;
<span class="nc" id="L207">			return false ;</span>
		}
	}

	/**
	 * Safe and idempotent method for unregistering a {@link BroadcastReceiver}
	 * which might or might not still be registered in the given
	 * {@link Context}.
	 * @param ctx the context in which the receiver might be registered
	 * @param rcv the receiver to be unregistered
	 * @return {@code true} only if the unregister operation was completed
	 *  without throwing an exception
	 * @since zerobandwidth-net/android 0.1.7 (#50)
	 */
	public static boolean unregister( Context ctx, BroadcastReceiver rcv )
	{
<span class="fc" id="L223">		try { ctx.unregisterReceiver(rcv) ; return true ; }</span>
<span class="fc" id="L224">		catch( IllegalArgumentException xArg )</span>
		{
<span class="fc" id="L226">			Log.i( LOG_TAG, (new StringBuilder())</span>
<span class="fc" id="L227">						.append( &quot;Class [&quot; )</span>
<span class="fc" id="L228">						.append( rcv.getClass().getCanonicalName() )</span>
<span class="fc" id="L229">						.append( &quot;] was already not registered in this context.&quot; )</span>
<span class="fc" id="L230">						.toString()</span>
					, xArg
				);
<span class="fc" id="L233">			return false ;</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span>Generated by the Android Gradle plugin 2.2.0</div></body></html>